(function(){angular.module("rachioWinterizinatorApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","LocalStorageModule","ngMdIcons"]).config(["$routeProvider",function(a){return a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/manage/:rachioKey",{templateUrl:"views/manage.html",controller:"MainManageCtrl",controllerAs:"manage"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}])}).call(this),function(){!function(){var a;return a=function(a){var b;b=this,b.apiKey=a.get("rachioApiKey"),b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.update=function(a){return b.apiKey=a,alert(b.apiKey)}},a.$inject=["localStorageService"],angular.module("rachioWinterizinatorApp").controller("MainCtrl",a)}()}.call(this),function(){"use strict";!function(){var a;return a=function(a,b,c,d){var e;e=this,e.rachioKey=a.rachioKey,e.keyIsValid=!0,e.personKey,e.rachioDeviceInfo,b.get("https://api.rach.io/1/public/person/info",{headers:{Authorization:"Bearer "+e.rachioKey}}).then(function(a){return c(function(){var b;return b=a.data,200===a.status?(d.set("rachioApiKey",e.rachioKey),e.keyIsValid=!0):e.KeyIsValid=!1,e.personKey=b.id,e.personKey.$apply,console.log(e.personKey),e.deviceInfo()})}),e.deviceInfo=function(){return console.log("getting all devices info"),b.get("https://api.rach.io/1/public/person/"+e.personKey,{headers:{Authorization:"Bearer "+e.rachioKey}}).then(function(a){return c(function(){var b;return console.log(a.status),b=a.data,e.rachioDeviceInfo=b.devices.concat(b.managedDevices)})})},e.allOff=function(a){return b.put("https://api.rach.io/1/public/device/stop_water",{id:a.id},{headers:{Authorization:"Bearer "+e.rachioKey}}).then(function(b){var c,d,e,f,g;if(console.log("stop all water request gave response "+b.status+", data "+b.data),204===b.status){for(f=a.zones,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.running=!1);return g}})},e.turnOn=function(a,c){return b.put("https://api.rach.io/1/public/zone/start",{id:c.id,duration:60},{headers:{Authorization:"Bearer "+e.rachioKey}}).then(function(b){var d,e,f,g;if(204===b.status){for(g=a.zones,e=0,f=g.length;f>e;e++)d=g[e],d.running=!1;c.running=!0,c.requestProcessing=!1}return console.log("start zone "+c.zoneNumber+" on device "+a.name+" gave response "+b.status+", data "+b.data)}),c.requestProcessing=!0}},a.$inject=["$routeParams","$http","$timeout","localStorageService"],angular.module("rachioWinterizinatorApp").controller("MainManageCtrl",a)}()}.call(this),function(){angular.module("rachioWinterizinatorApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]})}.call(this),angular.module("rachioWinterizinatorApp").run(["$templateCache",function(a){"use strict";a.put("views/about.html",'<h1>Winter is coming.</h1> <p>I need to quickly run through all of our Rachio Iro zones, in order to blow them out before the first frost. With the current Rachio app, that\'s pretty difficult.</p> <p>This app uses the Rachio API to allow you to simple turn zones on and off at will. It doesn\'t mess with your schedules, or anything.</p> <h2>What about security?</h2> <p>The entire app is open source. We\'ve designed it so your sprinkler control key never comes to our servers; it only stays on your computer and Rachio\'s.</p> <h2>Do you like it?</h2> <p>Contribute to my source code if you can. Or else, you can buy me a cup of coffee:</p> <p><a href="https://paypal.me/smartperson/5" target="_blank"><img src="/images/buy_coffee.79d720c6.png"></a></p>'),a.put("views/main.html",'<div class="row marketing"> <p> Winterizinator is a simple app to make it easier to blow out your Rachio Iro-powered sprinkler system at the end of the season. </p> </div> <div class="jumbotron"> <h1>Get Started</h1> <p class="lead"> <form novalidate class="css-form form-inline"> <div class="form-horizontal"> <label for="rachioKey"><a href="https://rachio.readme.io/docs/authentication" target="_blank"><ng-md-icon icon="help"></ng-md-icon></a> Rachio Key: </label> <input name="rachioKey" ng-model="main.apiKey"> </div> <a class="btn btn-success" ng-href="#/manage/{{main.apiKey}}">Go</a> </form> </p> <small>Your Rachio API key never reaches our server. We don\'t want it, anyway.</small> </div>'),a.put("views/manage.html",'Checking API Keyâ€¦ <span ng-if="manage.keyIsValid"><ng-md-icon icon="check_circle"></ng-md-icon></span> <span ng-if="!manage.keyIsValid"><ng-md-icon icon="error"></ng-md-icon></span> <div ng-if="!manage.keyIsValid"> <h1>Yikes!</h1> <p>We rant into a problem using the API key you gave us. Go back to the Rachio website, and copy and paste your API key again.</p> </div> <br> <div ng-repeat="device in manage.rachioDeviceInfo"> <h4>{{device.name}}</h4> <table class="table table-striped"> <tr> <th>#</th> <th>Name</th> <th></th> </tr> <tr ng-repeat="zone in device.zones | orderBy:\'zoneNumber\'"> <td>{{zone.zoneNumber}}</td> <td><img ng-src="{{zone.customNozzle.imageUrl}}" style="width:2em"> {{zone.name}}<span ng-if="!zone.enabled"> (disabled)</span> <span ng-if="zone.requestProcessing" style="float:right"><img src="https://www.drupal.org/files/issues/throbber_0.gif" class="ajax-loader"></span></td> <td> <button ng-if="!zone.running" ng-click="manage.turnOn(device, zone)" class="btn btn-success">Turn On</button> <button ng-if="zone.running" ng-click="manage.allOff(device)" class="btn btn-danger">Turn Off</button> </td> </tr> </table> </div>')}]);